(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
'use strict';

var _viewManager = require('./viewManager');

var _viewManager2 = _interopRequireDefault(_viewManager);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var viewmanager = new _viewManager2.default();

},{"./viewManager":2}],2:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var ViewManager = function ViewManager() {
  _classCallCheck(this, ViewManager);

  //initialize variables
  var vessel = void 0;
  var outputNumber = void 0;
  var vesselOptions = void 0;
  var currentOutput = 1;
  var check = "";
  var well_24 = [];
  var well_96 = [];
  var well_384 = [];
  var counter = 0;
  var letters = ["A", "B", "C", "D", "E", "F", "G", "H"];
  var flowRate = 0;
  var volume = 0;
  var density = 0;
  var dispense_time = 0;
  var start = 0;

  well_24[0] = 1;
  for (var i = 1; i < 384; i++) {
    well_24[i] = i + 1;
  };

  well_96[0] = 1;
  for (var i = 1; i < 96; i++) {
    well_96[i] = i + 1;
  };

  well_384[0] = 1;
  for (var i = 1; i < 384; i++) {
    well_384[i] = i + 1;
  }

  //methods
  function ab2str(buf) {
    return String.fromCharCode.apply(null, new Uint8Array(buf));
  };

  function str2ab_newline(str) {
    str = str + '\n';
    var buf = new ArrayBuffer(str.length); // 2 bytes for each char
    var bufView = new Uint8Array(buf);
    for (var i = 0, strLen = str.length; i < strLen; i++) {
      bufView[i] = str.charCodeAt(i);
    };
    return buf;
  };

  function str2ab(str) {
    var buf = new ArrayBuffer(str.length); // 2 bytes for each char
    var bufView = new Uint8Array(buf);
    for (var i = 0, strLen = str.length; i < strLen; i++) {
      bufView[i] = str.charCodeAt(i);
    };
    return buf;
  };

  function checkString(str, id) {
    var str_num = parseInt(str, 10);
    if (str_num > 0) {
      document.getElementById(id).style.borderColor = "green";
      document.getElementById(id).style.borderWidth = "0.15rem";
      return true;
    } else {
      document.getElementById(id).style.borderColor = "red";
      document.getElementById(id).style.borderWidth = "0.15rem";
      return false;
    }
  };

  //buttons
  this.inputButton = document.getElementById("inputButton");
  this.newButton = document.getElementById("resetButton");
  this.startButton = document.getElementById("startButton");

  //event handlers
  this.inputButton.addEventListener('click', function (event) {
    start = 1;
    vessel = document.getElementById('selectVessel').value;
    outputNumber = document.getElementById('outputNumber').value;
    flowRate = document.getElementById('inputFlow').value;
    volume = document.getElementById('inputVolume').value;
    density = document.getElementById('inputDensity').value;

    //Check that input values are valid
    checkString(outputNumber, "outputNumber");
    checkString(flowRate, "inputFlow");
    checkString(volume, "inputVolume");
    checkString(density, "inputDensity");

    //Calculate dispense time using model
    var sigma = 0.0415; // N*m
    var gravity = 9.8; // m/(s^2)
    var diameter = 0.003175; // m
    var pi = 3.14;
    var model_volume = sigma * diameter * pi / (density * gravity) * 1000000;
    //console.log(model_volume);
    var droplet_time = model_volume * (3600 / flowRate);
    //console.log(droplet_time);
    //console.log(Math.ceil(volume/model_volume));
    dispense_time = droplet_time * Math.ceil(volume / model_volume);
    //console.log(dispense_time);

    //Send data to Arduino after confirming validity of input information
    if (checkString(outputNumber, "outputNumber") && checkString(flowRate, "inputFlow") && checkString(volume, "inputVolume") && checkString(density, "inputDensity")) {
      //Model
      var data = outputNumber; //add + dispense time
      socket.emit("send-raw", {
        "name": '/dev/cu.usbmodem1411',
        "payload": str2ab_newline(data)
      });
    };

    //create output tabs
    var nav = "";
    var nav_content = "";
    var vessel_ID = "";
    var thead_ID = "";
    var tbody_ID = "";
    var thead_array = [];
    var tbody_array = [];
    for (var _k = 0; _k < outputNumber; _k++) {
      var output_insert = "Output" + (_k + 1);
      var output_btn_ID = "Submit" + (_k + 1);
      var output_btn_text = "Program Output " + (_k + 1);
      var navID = output_insert + "tab";
      var href_insert = "#" + output_insert;

      vessel_ID = "vessel" + _k;
      thead_ID = "thead" + _k;
      tbody_ID = "tbody" + _k;

      thead_array.push(thead_ID);
      tbody_array.push(tbody_ID);
      nav += "<a class='nav-item nav-link text-dark' id='" + navID + "' data-toggle='tab' href='" + href_insert + "' role='tab' aria-controls='" + output_insert + "' aria-selected='false'>" + (_k + 1) + "</a>";
      nav_content += "<div class='tab-pane fade' id='" + output_insert + "' role='tabpanel' aria-labelledby='" + navID + "'><table class='table table-bordered table-sm' id='" + vessel_ID + "'><thead id='" + thead_ID + "'></thead><tbody id='" + tbody_ID + "'></tbody></table><button onclick = 'submitXY(this)' class='btn btn-success' name = '" + _k + "'id='" + output_btn_ID + "'>" + output_btn_text + "</button></div>";
    };

    document.getElementById('navTabs').innerHTML = nav;
    document.getElementById('navContent').innerHTML = nav_content;

    //create table for output vessel image
    //create 24-well plate
    if (vessel == 24 && checkString(outputNumber, "outputNumber") && checkString(flowRate, "inputFlow") && checkString(volume, "inputVolume") && checkString(density, "inputDensity")) {
      for (var k = 0; k < outputNumber; k++) {
        var thead_insert = "<th scope='col'> </th>";
        for (var i = 1; i < 7; i++) {
          thead_insert += "<th scope='col'>" + i + "</th>";
        };
        thead_insert += "</tr>";

        var tbody_insert = "";
        var _letters = ["A", "B", "C", "D"];
        for (var _i = 0; _i < 4; _i++) {
          tbody_insert += "<tr>";
          tbody_insert += "<th scope='row'>" + _letters[_i] + "</th>";
          for (var _j = 1; _j < 7; _j++) {
            var coordinate = _letters[_i] + _j;
            var btnID = coordinate + k;
            tbody_insert += "<td><button type='button' name='" + k + "' class='grid-button btn btn-sm text-white' onclick='appendXY(this)' value='" + _j + "' id='" + btnID + "'>" + coordinate + "</button></td>";
          };
          tbody_insert += "</tr>";
        };

        document.getElementById(tbody_array[k]).innerHTML = tbody_insert;
        document.getElementById(thead_array[k]).innerHTML = thead_insert;
      };

      counter = 0;
      for (var k = 0; k < outputNumber; k++) {
        counter = 0;
        for (var _i2 = 0; _i2 < 4; _i2++) {
          for (var _j2 = 1; _j2 < 7; _j2++) {
            var identifier = letters[_i2] + _j2 + k;
            document.getElementById(identifier).value = well_24[counter];
            counter = counter + 1;
          }
        }
      }
    };

    //create 96-well plate
    if (vessel == 96 && checkString(outputNumber, "outputNumber") && checkString(flowRate, "inputFlow") && checkString(volume, "inputVolume") && checkString(density, "inputDensity")) {
      for (var k = 0; k < outputNumber; k++) {
        var _thead_insert = "<th scope='col'> </th>";
        for (var i = 1; i < 13; i++) {
          _thead_insert += "<th scope='col'>" + i + "</th>";
        };
        _thead_insert += "</tr>";

        var _tbody_insert = "";
        var _letters2 = ["A", "B", "C", "D", "E", "F", "G", "H"];

        for (var i = 0; i < 8; i++) {
          _tbody_insert += "<tr>";
          _tbody_insert += "<th scope='row'>" + _letters2[i] + "</th>";
          for (var j = 1; j < 13; j++) {
            var _coordinate = _letters2[i] + j;
            var _btnID = _coordinate + k;
            _tbody_insert += "<td><button type='button' name='" + k + "' class='grid-button btn btn-sm text-white' onclick='appendXY(this)' value='" + _coordinate + "' id='" + _btnID + "'>" + _coordinate + "</button></td>";
          };
          _tbody_insert += "</tr>";
        };

        document.getElementById(tbody_array[k]).innerHTML = _tbody_insert;
        document.getElementById(thead_array[k]).innerHTML = _thead_insert;
      };

      counter = 0;
      for (var _k2 = 0; _k2 < outputNumber; _k2++) {
        counter = 0;
        for (var i = 0; i < 8; i++) {
          for (var j = 1; j < 13; j++) {
            var _identifier = letters[i] + j + _k2;
            document.getElementById(_identifier).value = well_96[counter];
            counter = counter + 1;
          };
        };
      };
    };

    //create 384-well plate
    if (vessel == 384 && checkString(outputNumber, "outputNumber") && checkString(flowRate, "inputFlow") && checkString(volume, "inputVolume") && checkString(density, "inputDensity")) {
      for (var k = 0; k < outputNumber; k++) {
        var _thead_insert2 = "<th scope='col'> </th>";
        for (var i = 1; i < 25; i++) {
          _thead_insert2 += "<th scope='col'>" + i + "</th>";
        };
        _thead_insert2 += "</tr>";

        var _tbody_insert2 = "";
        var _letters3 = ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P"];
        for (var i = 0; i < 15; i++) {
          _tbody_insert2 += "<tr>";
          _tbody_insert2 += "<th scope='row'>" + _letters3[i] + "</th>";
          for (var j = 1; j < 25; j++) {
            var _coordinate2 = _letters3[i] + j;
            _tbody_insert2 += "<td><button type='button' class='grid-button btn btn-sm text-white' onclick='appendXY(this)' value='" + _coordinate2 + "' id='" + _coordinate2 + "'>" + _coordinate2 + "</button></td>";
          };
          _tbody_insert2 += "</tr>";
        };
        document.getElementById(tbody_array[k]).innerHTML = _tbody_insert2;
        document.getElementById(thead_array[k]).innerHTML = _thead_insert2;
      };
    };
  });

  this.newButton.addEventListener('click', function (event) {
    var resetData = 'r';
    socket.emit("send-raw", {
      "name": '/dev/cu.usbmodem1411',
      "payload": str2ab_newline(resetData)
    });
  });

  this.startButton.addEventListener('click', function (event) {
    var pi = 3.14;
    var nozzle_volume = (0.0008 ^ 2) * pi * 0.18;
    var adapter_volume = (0.0008 ^ 2) * pi * 0.24;
    var total_volume = nozzle_volume + adapter_volume;
    var flush_time = Math.ceil(3600 / flowRate * total_volume + 180); //seconds
    var sendData = dispense_time.toString() + " " + flush_time.toString();
    if (start == 1) {
      socket.emit("send-raw", {
        "name": '/dev/cu.usbmodem1411',
        "payload": str2ab_newline(sendData)
      });
    };
  });
};

exports.default = ViewManager;
;

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhcHAvc2V0dXAuanMiLCJhcHAvdmlld01hbmFnZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7OztBQ0VBLElBQUksY0FBYyxJQUFsQixxQkFBa0IsRUFBbEI7Ozs7Ozs7Ozs7O0lDRmUsVyxHQUNiLHVCQUFjO0FBQUE7O0FBQ1o7QUFDQSxNQUFBLGVBQUE7QUFDQSxNQUFBLHFCQUFBO0FBQ0EsTUFBQSxzQkFBQTtBQUNBLE1BQUksZ0JBQUosQ0FBQTtBQUNBLE1BQUksUUFBSixFQUFBO0FBQ0EsTUFBSSxVQUFKLEVBQUE7QUFDQSxNQUFJLFVBQUosRUFBQTtBQUNBLE1BQUksV0FBSixFQUFBO0FBQ0EsTUFBSSxVQUFKLENBQUE7QUFDQSxNQUFJLFVBQVUsQ0FBQSxHQUFBLEVBQUEsR0FBQSxFQUFBLEdBQUEsRUFBQSxHQUFBLEVBQUEsR0FBQSxFQUFBLEdBQUEsRUFBQSxHQUFBLEVBQWQsR0FBYyxDQUFkO0FBQ0EsTUFBSSxXQUFKLENBQUE7QUFDQSxNQUFJLFNBQUosQ0FBQTtBQUNBLE1BQUksVUFBSixDQUFBO0FBQ0EsTUFBSSxnQkFBSixDQUFBO0FBQ0EsTUFBSSxRQUFKLENBQUE7O0FBRUEsVUFBQSxDQUFBLElBQUEsQ0FBQTtBQUNBLE9BQUssSUFBSSxJQUFULENBQUEsRUFBZ0IsSUFBaEIsR0FBQSxFQUFBLEdBQUEsRUFBOEI7QUFDNUIsWUFBQSxDQUFBLElBQWEsSUFBYixDQUFBO0FBQ0Q7O0FBRUQsVUFBQSxDQUFBLElBQUEsQ0FBQTtBQUNBLE9BQUssSUFBSSxJQUFULENBQUEsRUFBZ0IsSUFBaEIsRUFBQSxFQUFBLEdBQUEsRUFBNkI7QUFDM0IsWUFBQSxDQUFBLElBQWEsSUFBYixDQUFBO0FBQ0Q7O0FBRUQsV0FBQSxDQUFBLElBQUEsQ0FBQTtBQUNBLE9BQUssSUFBSSxJQUFULENBQUEsRUFBZ0IsSUFBaEIsR0FBQSxFQUFBLEdBQUEsRUFB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QUFBLENBQVksT0FBRCxRQUFDLEdBQUYsWUFBRSxHQUwyQixHQUt2QyxDQUFqQixDQUx3RCxDQUtRO0FBQ2hFLFFBQUksV0FBVyxjQUFBLFFBQUEsS0FBQSxHQUFBLEdBQWlDLFdBQWhELFFBQWdELEVBQWhEO0FBQ0EsUUFBRyxTQUFILENBQUEsRUFBYztBQUNaLGFBQUEsSUFBQSxDQUFBLFVBQUEsRUFBd0I7QUFDdEIsZ0JBRHNCLHNCQUFBO0FBRXRCLG1CQUFXLGVBQUEsUUFBQTtBQUZXLE9BQXhCO0FBSUQ7QUFaSCxHQUFBO0FBZUQsQzs7a0JBclJZLFc7QUFzUmQiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJpbXBvcnQgVmlld01hbmFnZXIgZnJvbSAnLi92aWV3TWFuYWdlcic7XG5cbmxldCB2aWV3bWFuYWdlciA9IG5ldyBWaWV3TWFuYWdlcigpO1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmlld01hbmFnZXIge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICAvL2luaXRpYWxpemUgdmFyaWFibGVzXG4gICAgbGV0IHZlc3NlbDtcbiAgICBsZXQgb3V0cHV0TnVtYmVyO1xuICAgIGxldCB2ZXNzZWxPcHRpb25zO1xuICAgIGxldCBjdXJyZW50T3V0cHV0ID0gMTtcbiAgICBsZXQgY2hlY2sgPSBcIlwiO1xuICAgIGxldCB3ZWxsXzI0ID0gW107XG4gICAgbGV0IHdlbGxfOTYgPSBbXTtcbiAgICBsZXQgd2VsbF8zODQgPSBbXTtcbiAgICBsZXQgY291bnRlciA9IDA7XG4gICAgbGV0IGxldHRlcnMgPSBbXCJBXCIsIFwiQlwiLCBcIkNcIiwgXCJEXCIsIFwiRVwiLCBcIkZcIiwgXCJHXCIsIFwiSFwiXTtcbiAgICBsZXQgZmxvd1JhdGUgPSAwO1xuICAgIGxldCB2b2x1bWUgPSAwO1xuICAgIGxldCBkZW5zaXR5ID0gMDtcbiAgICBsZXQgZGlzcGVuc2VfdGltZSA9IDA7XG4gICAgbGV0IHN0YXJ0ID0gMDtcblxuICAgIHdlbGxfMjRbMF0gPSAxXG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCAzODQ7IGkrKykge1xuICAgICAgd2VsbF8yNFtpXSA9IGkgKyAxO1xuICAgIH07XG5cbiAgICB3ZWxsXzk2WzBdID0gMTtcbiAgICBmb3IgKHZhciBpID0gMTsgaSA8IDk2OyBpKyspIHtcbiAgICAgIHdlbGxfOTZbaV0gPSBpICsgMTtcbiAgICB9O1xuXG4gICAgd2VsbF8zODRbMF0gPSAxO1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgMzg0OyBpKyspIHtcbiAgICAgIHdlbGxfMzg0W2ldID0gaSArIDE7XG4gICAgfVxuXG4gICAgLy9tZXRob2RzXG4gICAgZnVuY3Rpb24gYWIyc3RyKGJ1Zikge1xuICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgbmV3IFVpbnQ4QXJyYXkoYnVmKSk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIHN0cjJhYl9uZXdsaW5lKHN0cikge1xuICAgICAgc3RyID0gc3RyICsgJ1xcbic7XG4gICAgICB2YXIgYnVmID0gbmV3IEFycmF5QnVmZmVyKHN0ci5sZW5ndGgpOyAvLyAyIGJ5dGVzIGZvciBlYWNoIGNoYXJcbiAgICAgIHZhciBidWZWaWV3ID0gbmV3IFVpbnQ4QXJyYXkoYnVmKTtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBzdHJMZW4gPSBzdHIubGVuZ3RoOyBpIDwgc3RyTGVuOyBpKyspIHtcbiAgICAgICAgYnVmVmlld1tpXSA9IHN0ci5jaGFyQ29kZUF0KGkpO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBidWY7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIHN0cjJhYihzdHIpIHtcbiAgICAgIHZhciBidWYgPSBuZXcgQXJyYXlCdWZmZXIoc3RyLmxlbmd0aCk7IC8vIDIgYnl0ZXMgZm9yIGVhY2ggY2hhclxuICAgICAgdmFyIGJ1ZlZpZXcgPSBuZXcgVWludDhBcnJheShidWYpO1xuICAgICAgZm9yICh2YXIgaSA9IDAsIHN0ckxlbiA9IHN0ci5sZW5ndGg7IGkgPCBzdHJMZW47IGkrKykge1xuICAgICAgICBidWZWaWV3W2ldID0gc3RyLmNoYXJDb2RlQXQoaSk7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIGJ1ZjtcbiAgICB9O1xuXG5cbiAgICBmdW5jdGlvbiBjaGVja1N0cmluZyhzdHIsaWQpIHtcbiAgICAgIGxldCBzdHJfbnVtID0gcGFyc2VJbnQoc3RyLDEwKTtcbiAgICAgIGlmIChzdHJfbnVtID4gMCkge1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkuc3R5bGUuYm9yZGVyQ29sb3IgPSBcImdyZWVuXCI7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKS5zdHlsZS5ib3JkZXJXaWR0aCA9IFwiMC4xNXJlbVwiO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKS5zdHlsZS5ib3JkZXJDb2xvciA9IFwicmVkXCI7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKS5zdHlsZS5ib3JkZXJXaWR0aCA9IFwiMC4xNXJlbVwiO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cblxuICAgIH07XG5cbiAgICAvL2J1dHRvbnNcbiAgICB0aGlzLmlucHV0QnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJpbnB1dEJ1dHRvblwiKTtcbiAgICB0aGlzLm5ld0J1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVzZXRCdXR0b25cIik7XG4gICAgdGhpcy5zdGFydEJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3RhcnRCdXR0b25cIik7XG5cblxuICAgIC8vZXZlbnQgaGFuZGxlcnNcbiAgICB0aGlzLmlucHV0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIHN0YXJ0ID0gMTtcbiAgICAgIHZlc3NlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWxlY3RWZXNzZWwnKS52YWx1ZTtcbiAgICAgIG91dHB1dE51bWJlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvdXRwdXROdW1iZXInKS52YWx1ZTtcbiAgICAgIGZsb3dSYXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0RmxvdycpLnZhbHVlO1xuICAgICAgdm9sdW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0Vm9sdW1lJykudmFsdWU7XG4gICAgICBkZW5zaXR5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0RGVuc2l0eScpLnZhbHVlO1xuXG4gICAgICAvL0NoZWNrIHRoYXQgaW5wdXQgdmFsdWVzIGFyZSB2YWxpZFxuICAgICAgY2hlY2tTdHJpbmcob3V0cHV0TnVtYmVyLFwib3V0cHV0TnVtYmVyXCIpO1xuICAgICAgY2hlY2tTdHJpbmcoZmxvd1JhdGUsXCJpbnB1dEZsb3dcIik7XG4gICAgICBjaGVja1N0cmluZyh2b2x1bWUsXCJpbnB1dFZvbHVtZVwiKTtcbiAgICAgIGNoZWNrU3RyaW5nKGRlbnNpdHksXCJpbnB1dERlbnNpdHlcIik7XG5cbiAgICAgIC8vQ2FsY3VsYXRlIGRpc3BlbnNlIHRpbWUgdXNpbmcgbW9kZWxcbiAgICAgIGxldCBzaWdtYSA9IDAuMDQxNTsgLy8gTiptXG4gICAgICBsZXQgZ3Jhdml0eSA9IDkuODsgIC8vIG0vKHNeMilcbiAgICAgIGxldCBkaWFtZXRlciA9IDAuMDAzMTc1OyAvLyBtXG4gICAgICBsZXQgcGkgPSAzLjE0O1xuICAgICAgbGV0IG1vZGVsX3ZvbHVtZSA9ICgoc2lnbWEqZGlhbWV0ZXIqcGkpLyhkZW5zaXR5KmdyYXZpdHkpKSAqIDEwMDAwMDA7XG4gICAgICAvL2NvbnNvbGUubG9nKG1vZGVsX3ZvbHVtZSk7XG4gICAgICBsZXQgZHJvcGxldF90aW1lID0gbW9kZWxfdm9sdW1lICogKDM2MDAvZmxvd1JhdGUpO1xuICAgICAgLy9jb25zb2xlLmxvZyhkcm9wbGV0X3RpbWUpO1xuICAgICAgLy9jb25zb2xlLmxvZyhNYXRoLmNlaWwodm9sdW1lL21vZGVsX3ZvbHVtZSkpO1xuICAgICAgZGlzcGVuc2VfdGltZSA9IGRyb3BsZXRfdGltZSAqIE1hdGguY2VpbCh2b2x1bWUvbW9kZWxfdm9sdW1lKTtcbiAgICAgIC8vY29uc29sZS5sb2coZGlzcGVuc2VfdGltZSk7XG5cbiAgICAgIC8vU2VuZCBkYXRhIHRvIEFyZHVpbm8gYWZ0ZXIgY29uZmlybWluZyB2YWxpZGl0eSBvZiBpbnB1dCBpbmZvcm1hdGlvblxuICAgICAgaWYgKGNoZWNrU3RyaW5nKG91dHB1dE51bWJlcixcIm91dHB1dE51bWJlclwiKSAmJiBjaGVja1N0cmluZyhmbG93UmF0ZSxcImlucHV0Rmxvd1wiKSAmJiBjaGVja1N0cmluZyh2b2x1bWUsXCJpbnB1dFZvbHVtZVwiKSAmJiBjaGVja1N0cmluZyhkZW5zaXR5LFwiaW5wdXREZW5zaXR5XCIpKXtcbiAgICAgICAgLy9Nb2RlbFxuICAgICAgICBsZXQgZGF0YSA9IG91dHB1dE51bWJlcjsgLy9hZGQgKyBkaXNwZW5zZSB0aW1lXG4gICAgICAgIHNvY2tldC5lbWl0KFwic2VuZC1yYXdcIiwge1xuICAgICAgICAgIFwibmFtZVwiOiAnL2Rldi9jdS51c2Jtb2RlbTE0MTEnLFxuICAgICAgICAgIFwicGF5bG9hZFwiOiBzdHIyYWJfbmV3bGluZShkYXRhKVxuICAgICAgICB9KTtcbiAgICAgIH07XG5cblxuXG4gICAgICAvL2NyZWF0ZSBvdXRwdXQgdGFic1xuICAgICAgbGV0IG5hdiA9IFwiXCI7XG4gICAgICBsZXQgbmF2X2NvbnRlbnQgPSBcIlwiO1xuICAgICAgbGV0IHZlc3NlbF9JRCA9IFwiXCI7XG4gICAgICBsZXQgdGhlYWRfSUQgPSBcIlwiO1xuICAgICAgbGV0IHRib2R5X0lEID0gXCJcIjtcbiAgICAgIGxldCB0aGVhZF9hcnJheSA9IFtdO1xuICAgICAgbGV0IHRib2R5X2FycmF5ID0gW107XG4gICAgICBmb3IgKGxldCBrID0gMDsgayA8IG91dHB1dE51bWJlcjsgaysrKSB7XG4gICAgICAgIGxldCBvdXRwdXRfaW5zZXJ0ID0gXCJPdXRwdXRcIiArIChrICsgMSk7XG4gICAgICAgIGxldCBvdXRwdXRfYnRuX0lEID0gXCJTdWJtaXRcIiArIChrICsgMSk7XG4gICAgICAgIGxldCBvdXRwdXRfYnRuX3RleHQgPSBcIlByb2dyYW0gT3V0cHV0IFwiICsgKGsgKyAxKTtcbiAgICAgICAgbGV0IG5hdklEID0gb3V0cHV0X2luc2VydCArIFwidGFiXCI7XG4gICAgICAgIGxldCBocmVmX2luc2VydCA9IFwiI1wiICsgb3V0cHV0X2luc2VydDtcblxuICAgICAgICB2ZXNzZWxfSUQgPSBcInZlc3NlbFwiICsgaztcbiAgICAgICAgdGhlYWRfSUQgPSBcInRoZWFkXCIgKyBrO1xuICAgICAgICB0Ym9keV9JRCA9IFwidGJvZHlcIiArIGs7XG5cbiAgICAgICAgdGhlYWRfYXJyYXkucHVzaCh0aGVhZF9JRClcbiAgICAgICAgdGJvZHlfYXJyYXkucHVzaCh0Ym9keV9JRCk7XG4gICAgICAgIG5hdiArPSBcIjxhIGNsYXNzPSduYXYtaXRlbSBuYXYtbGluayB0ZXh0LWRhcmsnIGlkPSdcIiArIG5hdklEICsgXCInIGRhdGEtdG9nZ2xlPSd0YWInIGhyZWY9J1wiICsgaHJlZl9pbnNlcnQgKyBcIicgcm9sZT0ndGFiJyBhcmlhLWNvbnRyb2xzPSdcIiArIG91dHB1dF9pbnNlcnQgKyBcIicgYXJpYS1zZWxlY3RlZD0nZmFsc2UnPlwiICsgKGsgKyAxKSArIFwiPC9hPlwiO1xuICAgICAgICBuYXZfY29udGVudCArPSBcIjxkaXYgY2xhc3M9J3RhYi1wYW5lIGZhZGUnIGlkPSdcIiArIG91dHB1dF9pbnNlcnQgKyBcIicgcm9sZT0ndGFicGFuZWwnIGFyaWEtbGFiZWxsZWRieT0nXCIgKyBuYXZJRCArIFwiJz48dGFibGUgY2xhc3M9J3RhYmxlIHRhYmxlLWJvcmRlcmVkIHRhYmxlLXNtJyBpZD0nXCIgKyB2ZXNzZWxfSUQgKyBcIic+PHRoZWFkIGlkPSdcIiArIHRoZWFkX0lEICsgXCInPjwvdGhlYWQ+PHRib2R5IGlkPSdcIiArIHRib2R5X0lEICsgXCInPjwvdGJvZHk+PC90YWJsZT48YnV0dG9uIG9uY2xpY2sgPSAnc3VibWl0WFkodGhpcyknIGNsYXNzPSdidG4gYnRuLXN1Y2Nlc3MnIG5hbWUgPSAnXCIraytcIidpZD0nXCIgKyBvdXRwdXRfYnRuX0lEICsgXCInPlwiICsgb3V0cHV0X2J0bl90ZXh0ICsgXCI8L2J1dHRvbj48L2Rpdj5cIjtcbiAgICAgIH07XG5cbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYXZUYWJzJykuaW5uZXJIVE1MID0gbmF2O1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hdkNvbnRlbnQnKS5pbm5lckhUTUwgPSBuYXZfY29udGVudDtcblxuICAgICAgLy9jcmVhdGUgdGFibGUgZm9yIG91dHB1dCB2ZXNzZWwgaW1hZ2VcbiAgICAgIC8vY3JlYXRlIDI0LXdlbGwgcGxhdGVcbiAgICAgIGlmICgodmVzc2VsID09IDI0KSAmJiBjaGVja1N0cmluZyhvdXRwdXROdW1iZXIsXCJvdXRwdXROdW1iZXJcIikgJiYgY2hlY2tTdHJpbmcoZmxvd1JhdGUsXCJpbnB1dEZsb3dcIikgJiYgY2hlY2tTdHJpbmcodm9sdW1lLFwiaW5wdXRWb2x1bWVcIikgJiYgY2hlY2tTdHJpbmcoZGVuc2l0eSxcImlucHV0RGVuc2l0eVwiKSApIHtcbiAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBvdXRwdXROdW1iZXI7IGsrKykge1xuICAgICAgICAgIGxldCB0aGVhZF9pbnNlcnQgPSBcIjx0aCBzY29wZT0nY29sJz4gPC90aD5cIjtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IDc7IGkrKykge1xuICAgICAgICAgICAgdGhlYWRfaW5zZXJ0ICs9IFwiPHRoIHNjb3BlPSdjb2wnPlwiICsgaSArIFwiPC90aD5cIjtcbiAgICAgICAgICB9O1xuICAgICAgICAgIHRoZWFkX2luc2VydCArPSBcIjwvdHI+XCI7XG5cbiAgICAgICAgICBsZXQgdGJvZHlfaW5zZXJ0ID0gXCJcIjtcbiAgICAgICAgICBsZXQgbGV0dGVycyA9IFtcIkFcIiwgXCJCXCIsIFwiQ1wiLCBcIkRcIl07XG4gICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspIHtcbiAgICAgICAgICAgIHRib2R5X2luc2VydCArPSBcIjx0cj5cIjtcbiAgICAgICAgICAgIHRib2R5X2luc2VydCArPSBcIjx0aCBzY29wZT0ncm93Jz5cIiArIGxldHRlcnNbaV0gKyBcIjwvdGg+XCI7XG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMTsgaiA8IDc7IGorKykge1xuICAgICAgICAgICAgICBsZXQgY29vcmRpbmF0ZSA9IGxldHRlcnNbaV0gKyBqO1xuICAgICAgICAgICAgICBsZXQgYnRuSUQgPSBjb29yZGluYXRlICsgaztcbiAgICAgICAgICAgICAgdGJvZHlfaW5zZXJ0ICs9IFwiPHRkPjxidXR0b24gdHlwZT0nYnV0dG9uJyBuYW1lPSdcIitrK1wiJyBjbGFzcz0nZ3JpZC1idXR0b24gYnRuIGJ0bi1zbSB0ZXh0LXdoaXRlJyBvbmNsaWNrPSdhcHBlbmRYWSh0aGlzKScgdmFsdWU9J1wiICsgaiArIFwiJyBpZD0nXCIgKyBidG5JRCArIFwiJz5cIiArIGNvb3JkaW5hdGUgKyBcIjwvYnV0dG9uPjwvdGQ+XCI7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGJvZHlfaW5zZXJ0ICs9IFwiPC90cj5cIjtcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGJvZHlfYXJyYXlba10pLmlubmVySFRNTCA9IHRib2R5X2luc2VydDtcbiAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGVhZF9hcnJheVtrXSkuaW5uZXJIVE1MID0gdGhlYWRfaW5zZXJ0O1xuICAgICAgICB9O1xuXG4gICAgICAgIGNvdW50ZXIgPSAwO1xuICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IG91dHB1dE51bWJlcjsgaysrKSB7XG4gICAgICAgICAgY291bnRlciA9IDA7XG4gICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspIHtcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAxOyBqIDwgNzsgaisrKSB7XG4gICAgICAgICAgICAgIGxldCBpZGVudGlmaWVyID0gbGV0dGVyc1tpXSArIGogKyBrO1xuICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZGVudGlmaWVyKS52YWx1ZSA9IHdlbGxfMjRbY291bnRlcl07XG4gICAgICAgICAgICAgIGNvdW50ZXIgPSBjb3VudGVyICsgMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIC8vY3JlYXRlIDk2LXdlbGwgcGxhdGVcbiAgICAgIGlmICgodmVzc2VsID09IDk2KSAmJiBjaGVja1N0cmluZyhvdXRwdXROdW1iZXIsXCJvdXRwdXROdW1iZXJcIikgJiYgY2hlY2tTdHJpbmcoZmxvd1JhdGUsXCJpbnB1dEZsb3dcIikgJiYgY2hlY2tTdHJpbmcodm9sdW1lLFwiaW5wdXRWb2x1bWVcIikgJiYgY2hlY2tTdHJpbmcoZGVuc2l0eSxcImlucHV0RGVuc2l0eVwiKSkge1xuICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IG91dHB1dE51bWJlcjsgaysrKSB7XG4gICAgICAgICAgbGV0IHRoZWFkX2luc2VydCA9IFwiPHRoIHNjb3BlPSdjb2wnPiA8L3RoPlwiO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgMTM7IGkrKykge1xuICAgICAgICAgICAgdGhlYWRfaW5zZXJ0ICs9IFwiPHRoIHNjb3BlPSdjb2wnPlwiICsgaSArIFwiPC90aD5cIjtcbiAgICAgICAgICB9O1xuICAgICAgICAgIHRoZWFkX2luc2VydCArPSBcIjwvdHI+XCI7XG5cbiAgICAgICAgICBsZXQgdGJvZHlfaW5zZXJ0ID0gXCJcIjtcbiAgICAgICAgICBsZXQgbGV0dGVycyA9IFtcIkFcIiwgXCJCXCIsIFwiQ1wiLCBcIkRcIiwgXCJFXCIsIFwiRlwiLCBcIkdcIiwgXCJIXCJdO1xuXG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA4OyBpKyspIHtcbiAgICAgICAgICAgIHRib2R5X2luc2VydCArPSBcIjx0cj5cIjtcbiAgICAgICAgICAgIHRib2R5X2luc2VydCArPSBcIjx0aCBzY29wZT0ncm93Jz5cIiArIGxldHRlcnNbaV0gKyBcIjwvdGg+XCI7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMTsgaiA8IDEzOyBqKyspIHtcbiAgICAgICAgICAgICAgbGV0IGNvb3JkaW5hdGUgPSBsZXR0ZXJzW2ldICsgajtcbiAgICAgICAgICAgICAgbGV0IGJ0bklEID0gY29vcmRpbmF0ZSArIGs7XG4gICAgICAgICAgICAgIHRib2R5X2luc2VydCArPSBcIjx0ZD48YnV0dG9uIHR5cGU9J2J1dHRvbicgbmFtZT0nXCIraytcIicgY2xhc3M9J2dyaWQtYnV0dG9uIGJ0biBidG4tc20gdGV4dC13aGl0ZScgb25jbGljaz0nYXBwZW5kWFkodGhpcyknIHZhbHVlPSdcIiArIGNvb3JkaW5hdGUgKyBcIicgaWQ9J1wiICsgYnRuSUQgKyBcIic+XCIgKyBjb29yZGluYXRlICsgXCI8L2J1dHRvbj48L3RkPlwiO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRib2R5X2luc2VydCArPSBcIjwvdHI+XCI7XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRib2R5X2FycmF5W2tdKS5pbm5lckhUTUwgPSB0Ym9keV9pbnNlcnQ7XG4gICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhlYWRfYXJyYXlba10pLmlubmVySFRNTCA9IHRoZWFkX2luc2VydDtcbiAgICAgICAgfTtcblxuICAgICAgICBjb3VudGVyID0gMDtcbiAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBvdXRwdXROdW1iZXI7IGsrKykge1xuICAgICAgICAgIGNvdW50ZXIgPSAwO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgODsgaSsrKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMTsgaiA8IDEzOyBqKyspIHtcbiAgICAgICAgICAgICAgbGV0IGlkZW50aWZpZXIgPSBsZXR0ZXJzW2ldICsgaiArIGs7XG4gICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkZW50aWZpZXIpLnZhbHVlID0gd2VsbF85Nltjb3VudGVyXTtcbiAgICAgICAgICAgICAgY291bnRlciA9IGNvdW50ZXIgKyAxO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgfTtcblxuICAgICAgLy9jcmVhdGUgMzg0LXdlbGwgcGxhdGVcbiAgICAgIGlmICgodmVzc2VsID09IDM4NCkgJiYgY2hlY2tTdHJpbmcob3V0cHV0TnVtYmVyLFwib3V0cHV0TnVtYmVyXCIpICYmIGNoZWNrU3RyaW5nKGZsb3dSYXRlLFwiaW5wdXRGbG93XCIpICYmIGNoZWNrU3RyaW5nKHZvbHVtZSxcImlucHV0Vm9sdW1lXCIpICYmIGNoZWNrU3RyaW5nKGRlbnNpdHksXCJpbnB1dERlbnNpdHlcIikpIHtcbiAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBvdXRwdXROdW1iZXI7IGsrKykge1xuICAgICAgICAgIGxldCB0aGVhZF9pbnNlcnQgPSBcIjx0aCBzY29wZT0nY29sJz4gPC90aD5cIjtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IDI1OyBpKyspIHtcbiAgICAgICAgICAgIHRoZWFkX2luc2VydCArPSBcIjx0aCBzY29wZT0nY29sJz5cIiArIGkgKyBcIjwvdGg+XCI7XG4gICAgICAgICAgfTtcbiAgICAgICAgICB0aGVhZF9pbnNlcnQgKz0gXCI8L3RyPlwiO1xuXG4gICAgICAgICAgbGV0IHRib2R5X2luc2VydCA9IFwiXCI7XG4gICAgICAgICAgbGV0IGxldHRlcnMgPSBbXCJBXCIsIFwiQlwiLCBcIkNcIiwgXCJEXCIsIFwiRVwiLCBcIkZcIiwgXCJHXCIsIFwiSFwiLCBcIklcIiwgXCJKXCIsIFwiS1wiLCBcIkxcIiwgXCJNXCIsIFwiTlwiLCBcIk9cIiwgXCJQXCJdO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTU7IGkrKykge1xuICAgICAgICAgICAgdGJvZHlfaW5zZXJ0ICs9IFwiPHRyPlwiO1xuICAgICAgICAgICAgdGJvZHlfaW5zZXJ0ICs9IFwiPHRoIHNjb3BlPSdyb3cnPlwiICsgbGV0dGVyc1tpXSArIFwiPC90aD5cIjtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAxOyBqIDwgMjU7IGorKykge1xuICAgICAgICAgICAgICBsZXQgY29vcmRpbmF0ZSA9IGxldHRlcnNbaV0gKyBqO1xuICAgICAgICAgICAgICB0Ym9keV9pbnNlcnQgKz0gXCI8dGQ+PGJ1dHRvbiB0eXBlPSdidXR0b24nIGNsYXNzPSdncmlkLWJ1dHRvbiBidG4gYnRuLXNtIHRleHQtd2hpdGUnIG9uY2xpY2s9J2FwcGVuZFhZKHRoaXMpJyB2YWx1ZT0nXCIgKyBjb29yZGluYXRlICsgXCInIGlkPSdcIiArIGNvb3JkaW5hdGUgKyBcIic+XCIgKyBjb29yZGluYXRlICsgXCI8L2J1dHRvbj48L3RkPlwiO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRib2R5X2luc2VydCArPSBcIjwvdHI+XCI7XG4gICAgICAgICAgfTtcbiAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0Ym9keV9hcnJheVtrXSkuaW5uZXJIVE1MID0gdGJvZHlfaW5zZXJ0O1xuICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoZWFkX2FycmF5W2tdKS5pbm5lckhUTUwgPSB0aGVhZF9pbnNlcnQ7XG4gICAgICAgIH07XG4gICAgICB9O1xuICAgIH0pO1xuXG4gICAgdGhpcy5uZXdCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgbGV0IHJlc2V0RGF0YSA9ICdyJztcbiAgICAgIHNvY2tldC5lbWl0KFwic2VuZC1yYXdcIiwge1xuICAgICAgICBcIm5hbWVcIjogJy9kZXYvY3UudXNibW9kZW0xNDExJyxcbiAgICAgICAgXCJwYXlsb2FkXCI6IHN0cjJhYl9uZXdsaW5lKHJlc2V0RGF0YSlcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgdGhpcy5zdGFydEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KXtcbiAgICAgIGxldCBwaSA9IDMuMTQ7XG4gICAgICBsZXQgbm96emxlX3ZvbHVtZSA9ICgwLjAwMDheMikqcGkqMC4xODtcbiAgICAgIGxldCBhZGFwdGVyX3ZvbHVtZSA9ICgwLjAwMDheMikqcGkqMC4yNDtcbiAgICAgIGxldCB0b3RhbF92b2x1bWUgPSBub3p6bGVfdm9sdW1lICsgYWRhcHRlcl92b2x1bWU7XG4gICAgICBsZXQgZmx1c2hfdGltZSA9IE1hdGguY2VpbCgoKDM2MDAvZmxvd1JhdGUpKnRvdGFsX3ZvbHVtZSkrMTgwKTsgLy9zZWNvbmRzXG4gICAgICBsZXQgc2VuZERhdGEgPSBkaXNwZW5zZV90aW1lLnRvU3RyaW5nKCkgKyBcIiBcIiArIGZsdXNoX3RpbWUudG9TdHJpbmcoKTtcbiAgICAgIGlmKHN0YXJ0ID09IDEpe1xuICAgICAgICBzb2NrZXQuZW1pdChcInNlbmQtcmF3XCIsIHtcbiAgICAgICAgICBcIm5hbWVcIjogJy9kZXYvY3UudXNibW9kZW0xNDExJyxcbiAgICAgICAgICBcInBheWxvYWRcIjogc3RyMmFiX25ld2xpbmUoc2VuZERhdGEpXG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICB9KTtcblxuICB9O1xufTtcbiJdfQ==
